from shodan import Shodan
from xml.dom import minidom
from xml.sax import parseString

SHODAN_API_KEY = 'CPc8hfIMGdAKd9joBuiH2TcF6kh0jwPI'
api = Shodan(SHODAN_API_KEY)

results = api.search('apache')
print('Results found: {}'.format(results['total']))

mydoc = minidom.parse('official-cpe-dictionary_v2.3.xml')
items = mydoc.getElementsByTagName('cpe-item')
#total amount of items
print(len(items))
for cpeNum in items:
    if cpeNum.getAttribute("name") == 'cpe:/a:10-strike:network_monitor:1.1':
        print("Yes")
        print(cpeNum.getAttribute("name"))

    #"cpe:/a:10-strike:network_monitor:1.0"
        
for result in results['matches']:
    print('IP: {}'.format(result['ip_str']))
    print(result['data'])
    try:
        print('Port: {}'.format(result['port']))
        print('CPE: {}'.format(result['cpe']))
    except:
        print(" ")
    
    print("______________________________________")
