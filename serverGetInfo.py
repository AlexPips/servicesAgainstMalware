from shodan import Shodan
from xml.dom import minidom

SHODAN_API_KEY = 'CPc8hfIMGdAKd9joBuiH2TcF6kh0jwPI'
api = Shodan(SHODAN_API_KEY)

results = api.search('apache')
print('Results found: {}'.format(results['total']))

mydoc = minidom.parse('official-cpe-dictionary_v2.3.xml')
items = mydoc.getElementsByTagName('cpe-item')
#total amount of items
print(len(items))

#dom = parseString('official-cpe-dictionary_v2.3.xml')
# for s in mydoc.getElementsByTagName('cpe-item'):
    # if s.getAttribute('name') == 'cpe:/a:10-strike:network_monitor:1.1':
        # print(s.childNodes[0].data)

    #cpeData = mydoc.getElementsByName("cpe:/a:10-strike:network_monitor:1.1")
        #"cpe:/a:10-strike:network_monitor:1.0"
        
for result in results['matches']:
    print('IP: {}'.format(result['ip_str']))
    print(result['data'])
    try:
        print('Port: {}'.format(result['cpe']))
    except:
        print(" ")
    
    print("______________________________________")
